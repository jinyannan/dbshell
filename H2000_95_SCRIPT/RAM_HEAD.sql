

\echo --------------RAM_HEAD------------
drop table IF EXISTS RAM_HEAD_GPTMP;

create table RAM_HEAD_GPTMP
(
  CMD_TYPE  VARCHAR(1),
  PRE_RAM_ID       VARCHAR(18),
  RAM_ID           VARCHAR(18)  ,
  CUT_ID           VARCHAR(18),
  RELATIVE_ID      VARCHAR(18),
  RAM_TYPE         VARCHAR(5),
  PROJECT_ID       VARCHAR(18),
  OWNER_CODE       VARCHAR(10),
  OWNER_NAME       VARCHAR(255),
  MASTER_CUSTOMS   VARCHAR(4),
  LINKMAN          VARCHAR(255),
  I_DATE           TIMESTAMP,
  INPUT_DATE       TIMESTAMP,
  INPUT_ER         VARCHAR(8),
  PRE_PRINT_ER     VARCHAR(8),
  PRE_PRINT_DATE   TIMESTAMP,
  DECL_DATE        TIMESTAMP,
  CHK_DATE         TIMESTAMP,
  CHK_ER           VARCHAR(8),
  CHECK_NOTE       VARCHAR(255),
  RECHK_DATE       TIMESTAMP,
  RECHK_ER         VARCHAR(8),
  RECHK_NOTE       VARCHAR(255),
  REPLY_DATE       TIMESTAMP,
  REPLY_ER         VARCHAR(8),
  REPLY_CHECK_NOTE VARCHAR(255),
  MODIFY_DATE      TIMESTAMP,
  MODIFY_ER        VARCHAR(8),
  MODIFY_NOTE      VARCHAR(255),
  EXE_MARK         VARCHAR(1),
  TOTAL_AMT        NUMERIC(19,4),
  PRINT_DATE       TIMESTAMP,
  PRINT_ER         VARCHAR(8),
  SOURCE_TYPE      VARCHAR(12),
  RESERVE1         VARCHAR(255),
  NOTE             VARCHAR(255),
  HASH_SIGN        VARCHAR(380),
  REASON           VARCHAR(255),
  LIMIT_DATE       TIMESTAMP,
  VERIFY_DATE      TIMESTAMP,
  ENTRY_ID         VARCHAR(18),
  RTX_DATE         TIMESTAMP,
  BANK_NAME        VARCHAR(255),
  DATE_BEGIN       TIMESTAMP,
  DATE_END         TIMESTAMP,
  MAX_LOAN_VALUE   NUMERIC(19,4),
  TAX_AMT          NUMERIC(19,4),
  END_LOAN_DATE    TIMESTAMP,
  END_LOAN_ER      VARCHAR(8),
  UNFREEZE_TYPE    VARCHAR(2),
  I_E_PORT         VARCHAR(4),
  CUT_APP_REASON   VARCHAR(255),
  CUT_FILE         VARCHAR(255),
  I_E_ZGCUST       VARCHAR(4),
  IM_CUSTOMS_CODE  VARCHAR(4),
  IM_COP_CODE      VARCHAR(10),
  IM_COP_NAME      VARCHAR(255),
  IM_PROJECT_ID    VARCHAR(18),
  IM_LINKMAN       VARCHAR(255),
  YD_REPLY_ER      VARCHAR(8),
  YD_REPLY_DATE    TIMESTAMP,
  YD_REPLY_NOTE    VARCHAR(255),
  REAL_DUTY        NUMERIC(19,4),
  REAL_TAX         NUMERIC(19,4),
  REAL_REG         NUMERIC(19,4),
  REAL_ANTI        NUMERIC(19,4),
  REAL_OTHER       NUMERIC(19,4)
)
DISTRIBUTED BY (RAM_ID);


\echo --------------RAM_HEAD------------
drop table IF EXISTS RAM_HEAD_GPTMP_TODAY;

create table RAM_HEAD_GPTMP_TODAY
(
  CMD_TYPE  VARCHAR(1),
  PRE_RAM_ID       VARCHAR(18),
  RAM_ID           VARCHAR(18)  ,
  CUT_ID           VARCHAR(18),
  RELATIVE_ID      VARCHAR(18),
  RAM_TYPE         VARCHAR(5),
  PROJECT_ID       VARCHAR(18),
  OWNER_CODE       VARCHAR(10),
  OWNER_NAME       VARCHAR(255),
  MASTER_CUSTOMS   VARCHAR(4),
  LINKMAN          VARCHAR(255),
  I_DATE           TIMESTAMP,
  INPUT_DATE       TIMESTAMP,
  INPUT_ER         VARCHAR(8),
  PRE_PRINT_ER     VARCHAR(8),
  PRE_PRINT_DATE   TIMESTAMP,
  DECL_DATE        TIMESTAMP,
  CHK_DATE         TIMESTAMP,
  CHK_ER           VARCHAR(8),
  CHECK_NOTE       VARCHAR(255),
  RECHK_DATE       TIMESTAMP,
  RECHK_ER         VARCHAR(8),
  RECHK_NOTE       VARCHAR(255),
  REPLY_DATE       TIMESTAMP,
  REPLY_ER         VARCHAR(8),
  REPLY_CHECK_NOTE VARCHAR(255),
  MODIFY_DATE      TIMESTAMP,
  MODIFY_ER        VARCHAR(8),
  MODIFY_NOTE      VARCHAR(255),
  EXE_MARK         VARCHAR(1),
  TOTAL_AMT        NUMERIC(19,4),
  PRINT_DATE       TIMESTAMP,
  PRINT_ER         VARCHAR(8),
  SOURCE_TYPE      VARCHAR(12),
  RESERVE1         VARCHAR(255),
  NOTE             VARCHAR(255),
  HASH_SIGN        VARCHAR(380),
  REASON           VARCHAR(255),
  LIMIT_DATE       TIMESTAMP,
  VERIFY_DATE      TIMESTAMP,
  ENTRY_ID         VARCHAR(18),
  RTX_DATE         TIMESTAMP,
  BANK_NAME        VARCHAR(255),
  DATE_BEGIN       TIMESTAMP,
  DATE_END         TIMESTAMP,
  MAX_LOAN_VALUE   NUMERIC(19,4),
  TAX_AMT          NUMERIC(19,4),
  END_LOAN_DATE    TIMESTAMP,
  END_LOAN_ER      VARCHAR(8),
  UNFREEZE_TYPE    VARCHAR(2),
  I_E_PORT         VARCHAR(4),
  CUT_APP_REASON   VARCHAR(255),
  CUT_FILE         VARCHAR(255),
  I_E_ZGCUST       VARCHAR(4),
  IM_CUSTOMS_CODE  VARCHAR(4),
  IM_COP_CODE      VARCHAR(10),
  IM_COP_NAME      VARCHAR(255),
  IM_PROJECT_ID    VARCHAR(18),
  IM_LINKMAN       VARCHAR(255),
  YD_REPLY_ER      VARCHAR(8),
  YD_REPLY_DATE    TIMESTAMP,
  YD_REPLY_NOTE    VARCHAR(255),
  REAL_DUTY        NUMERIC(19,4),
  REAL_TAX         NUMERIC(19,4),
  REAL_REG         NUMERIC(19,4),
  REAL_ANTI        NUMERIC(19,4),
  REAL_OTHER       NUMERIC(19,4)
)
DISTRIBUTED BY (RAM_ID);


\echo --------------RAM_HEAD------------
drop external table IF EXISTS RAM_HEAD_INC_EXT;

create external table RAM_HEAD_INC_EXT
(
  CMD_TYPE    VARCHAR(1),
  PRE_RAM_ID       VARCHAR(18),
  RAM_ID           VARCHAR(18)  ,
  CUT_ID           VARCHAR(18),
  RELATIVE_ID      VARCHAR(18),
  RAM_TYPE         VARCHAR(5),
  PROJECT_ID       VARCHAR(18),
  OWNER_CODE       VARCHAR(10),
  OWNER_NAME       VARCHAR(255),
  MASTER_CUSTOMS   VARCHAR(4),
  LINKMAN          VARCHAR(255),
  I_DATE           TIMESTAMP,
  INPUT_DATE       TIMESTAMP,
  INPUT_ER         VARCHAR(8),
  PRE_PRINT_ER     VARCHAR(8),
  PRE_PRINT_DATE   TIMESTAMP,
  DECL_DATE        TIMESTAMP,
  CHK_DATE         TIMESTAMP,
  CHK_ER           VARCHAR(8),
  CHECK_NOTE       VARCHAR(255),
  RECHK_DATE       TIMESTAMP,
  RECHK_ER         VARCHAR(8),
  RECHK_NOTE       VARCHAR(255),
  REPLY_DATE       TIMESTAMP,
  REPLY_ER         VARCHAR(8),
  REPLY_CHECK_NOTE VARCHAR(255),
  MODIFY_DATE      TIMESTAMP,
  MODIFY_ER        VARCHAR(8),
  MODIFY_NOTE      VARCHAR(255),
  EXE_MARK         VARCHAR(1),
  TOTAL_AMT        NUMERIC(19,4),
  PRINT_DATE       TIMESTAMP,
  PRINT_ER         VARCHAR(8),
  SOURCE_TYPE      VARCHAR(12),
  RESERVE1         VARCHAR(255),
  NOTE             VARCHAR(255),
  HASH_SIGN        VARCHAR(380),
  REASON           VARCHAR(255),
  LIMIT_DATE       TIMESTAMP,
  VERIFY_DATE      TIMESTAMP,
  ENTRY_ID         VARCHAR(18),
  RTX_DATE         TIMESTAMP,
  BANK_NAME        VARCHAR(255),
  DATE_BEGIN       TIMESTAMP,
  DATE_END         TIMESTAMP,
  MAX_LOAN_VALUE   NUMERIC(19,4),
  TAX_AMT          NUMERIC(19,4),
  END_LOAN_DATE    TIMESTAMP,
  END_LOAN_ER      VARCHAR(8),
  UNFREEZE_TYPE    VARCHAR(2),
  I_E_PORT         VARCHAR(4),
  CUT_APP_REASON   VARCHAR(255),
  CUT_FILE         VARCHAR(255),
  I_E_ZGCUST       VARCHAR(4),
  IM_CUSTOMS_CODE  VARCHAR(4),
  IM_COP_CODE      VARCHAR(10),
  IM_COP_NAME      VARCHAR(255),
  IM_PROJECT_ID    VARCHAR(18),
  IM_LINKMAN       VARCHAR(255),
  YD_REPLY_ER      VARCHAR(8),
  YD_REPLY_DATE    TIMESTAMP,
  YD_REPLY_NOTE    VARCHAR(255),
  REAL_DUTY        NUMERIC(19,4),
  REAL_TAX         NUMERIC(19,4),
  REAL_REG         NUMERIC(19,4),
  REAL_ANTI        NUMERIC(19,4),
  REAL_OTHER       NUMERIC(19,4)
)
LOCATION( 
'gpfdist://mdw-1:8081/RAM_HEAD.txt',
'gpfdist://mdw-2:8081/RAM_HEAD.txt',
'gpfdist://mdw-3:8081/RAM_HEAD.txt',
'gpfdist://mdw-4:8081/RAM_HEAD.txt')
Format  'CSV'
(
DELIMITER  '|'
NULL  ''
QUOTE  '"'
ESCAPE  '"'
)
ENCODING  'UTF8'
LOG errors into error_table segment reject limit 10000;

\echo --------------RAM_HEAD------------
drop external table IF EXISTS RAM_HEAD_EXT;

create external table RAM_HEAD_EXT
(
  PRE_RAM_ID       VARCHAR(18),
  RAM_ID           VARCHAR(18)  ,
  CUT_ID           VARCHAR(18),
  RELATIVE_ID      VARCHAR(18),
  RAM_TYPE         VARCHAR(5),
  PROJECT_ID       VARCHAR(18),
  OWNER_CODE       VARCHAR(10),
  OWNER_NAME       VARCHAR(255),
  MASTER_CUSTOMS   VARCHAR(4),
  LINKMAN          VARCHAR(255),
  I_DATE           TIMESTAMP,
  INPUT_DATE       TIMESTAMP,
  INPUT_ER         VARCHAR(8),
  PRE_PRINT_ER     VARCHAR(8),
  PRE_PRINT_DATE   TIMESTAMP,
  DECL_DATE        TIMESTAMP,
  CHK_DATE         TIMESTAMP,
  CHK_ER           VARCHAR(8),
  CHECK_NOTE       VARCHAR(255),
  RECHK_DATE       TIMESTAMP,
  RECHK_ER         VARCHAR(8),
  RECHK_NOTE       VARCHAR(255),
  REPLY_DATE       TIMESTAMP,
  REPLY_ER         VARCHAR(8),
  REPLY_CHECK_NOTE VARCHAR(255),
  MODIFY_DATE      TIMESTAMP,
  MODIFY_ER        VARCHAR(8),
  MODIFY_NOTE      VARCHAR(255),
  EXE_MARK         VARCHAR(1),
  TOTAL_AMT        NUMERIC(19,4),
  PRINT_DATE       TIMESTAMP,
  PRINT_ER         VARCHAR(8),
  SOURCE_TYPE      VARCHAR(12),
  RESERVE1         VARCHAR(255),
  NOTE             VARCHAR(255),
  HASH_SIGN        VARCHAR(380),
  REASON           VARCHAR(255),
  LIMIT_DATE       TIMESTAMP,
  VERIFY_DATE      TIMESTAMP,
  ENTRY_ID         VARCHAR(18),
  RTX_DATE         TIMESTAMP,
  BANK_NAME        VARCHAR(255),
  DATE_BEGIN       TIMESTAMP,
  DATE_END         TIMESTAMP,
  MAX_LOAN_VALUE   NUMERIC(19,4),
  TAX_AMT          NUMERIC(19,4),
  END_LOAN_DATE    TIMESTAMP,
  END_LOAN_ER      VARCHAR(8),
  UNFREEZE_TYPE    VARCHAR(2),
  I_E_PORT         VARCHAR(4),
  CUT_APP_REASON   VARCHAR(255),
  CUT_FILE         VARCHAR(255),
  I_E_ZGCUST       VARCHAR(4),
  IM_CUSTOMS_CODE  VARCHAR(4),
  IM_COP_CODE      VARCHAR(10),
  IM_COP_NAME      VARCHAR(255),
  IM_PROJECT_ID    VARCHAR(18),
  IM_LINKMAN       VARCHAR(255),
  YD_REPLY_ER      VARCHAR(8),
  YD_REPLY_DATE    TIMESTAMP,
  YD_REPLY_NOTE    VARCHAR(255),
  REAL_DUTY        NUMERIC(19,4),
  REAL_TAX         NUMERIC(19,4),
  REAL_REG         NUMERIC(19,4),
  REAL_ANTI        NUMERIC(19,4),
  REAL_OTHER       NUMERIC(19,4)
)
LOCATION( 
'gpfdist://sdw5-1:8081/RAM_HEAD.txt',
'gpfdist://sdw5-2:8081/RAM_HEAD.txt',
'gpfdist://sdw5-3:8081/RAM_HEAD.txt',
'gpfdist://sdw5-4:8081/RAM_HEAD.txt')
Format  'CSV'
(
DELIMITER  '|'
NULL  ''
QUOTE  '"'
ESCAPE  '"'
)
ENCODING  'gb18030'
LOG errors into error_table segment reject limit 10000;


drop table IF EXISTS  RAM_HEAD;

create table RAM_HEAD  as ( select * from RAM_HEAD_EXT )  DISTRIBUTED BY (RAM_ID);


